# Misaka Cipher - Logging Configuration
# Full traceability with Trace_ID for all transactions

logging:
  # Global Settings
  version: 1
  disable_existing_loggers: false
  
  # Log Levels: DEBUG, INFO, WARNING, ERROR, CRITICAL
  root_level: "INFO"
  
  # Output Formats
  formatters:
    standard:
      format: '[%(asctime)s] [%(levelname)s] [Trace:%(trace_id)s] %(name)s - %(message)s'
      datefmt: '%Y-%m-%d %H:%M:%S'
      
    detailed:
      format: |
        [%(asctime)s] [%(levelname)s]
        Trace ID: %(trace_id)s
        Module: %(name)s
        Function: %(funcName)s:%(lineno)d
        Message: %(message)s
      datefmt: '%Y-%m-%d %H:%M:%S'
      
    json:
      format: '{"timestamp": "%(asctime)s", "level": "%(levelname)s", "trace_id": "%(trace_id)s", "module": "%(name)s", "message": "%(message)s"}'
      datefmt: '%Y-%m-%dT%H:%M:%S'

  # Handlers
  handlers:
    console:
      class: logging.StreamHandler
      level: INFO
      formatter: standard
      stream: ext://sys.stdout
      
    file_standard:
      class: logging.handlers.RotatingFileHandler
      level: INFO
      formatter: standard
      filename: logs/misaka.log
      maxBytes: 10485760  # 10MB
      backupCount: 5
      encoding: utf8
      
    file_audit:
      class: logging.handlers.RotatingFileHandler
      level: INFO
      formatter: json
      filename: logs/audit.log
      maxBytes: 52428800  # 50MB
      backupCount: 10
      encoding: utf8
      
    file_security:
      class: logging.handlers.RotatingFileHandler
      level: WARNING
      formatter: detailed
      filename: logs/security.log
      maxBytes: 10485760  # 10MB
      backupCount: 10
      encoding: utf8

  # Loggers
  loggers:
    nexus_core:
      level: DEBUG
      handlers: [console, file_standard, file_audit]
      propagate: false
      
    security:
      level: WARNING
      handlers: [console, file_security, file_audit]
      propagate: false
      
    providers:
      level: INFO
      handlers: [console, file_standard]
      propagate: false
      
    factory:
      level: INFO
      handlers: [console, file_standard, file_audit]
      propagate: false
      
    forge:
      level: INFO
      handlers: [console, file_standard, file_audit]
      propagate: false

# Trace ID Configuration
trace_id:
  format: "MCTR-{timestamp}-{random}"  # Misaka Cipher Trace
  timestamp_format: "%Y%m%d%H%M%S"
  random_length: 8
  include_in_response: true

# Retention Policy
retention:
  standard_logs: 30  # days
  audit_logs: 365  # days
  security_logs: 730  # days (2 years)
  auto_cleanup: true
  cleanup_interval: 86400  # seconds (daily)

# Performance
performance:
  async_logging: true
  buffer_size: 1000
  flush_interval: 5  # seconds
